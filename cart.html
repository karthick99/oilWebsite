<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart | Senthoor Oils</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600&family=Playfair+Display:wght@600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="index.html" class="logo">Senthoor <span>Oils</span></a>
            <div class="mobile-menu-btn">‚ò∞</div>
            <ul class="nav-links">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="shop.html" class="nav-link">Shop</a></li>
                <li><a href="about.html" class="nav-link">Our Story</a></li>
                <li><a href="contact.html" class="nav-link">Contact</a></li>
            </ul>
            <div class="nav-actions">
                <a href="cart.html" class="cart-btn active" style="color: var(--color-primary);">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                    <span class="cart-count">0</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <header class="section-padding" style="margin-top: 60px; padding-bottom: 2rem;">
        <div class="container">
            <h1>Your Shopping Cart</h1>
        </div>
    </header>

    <!-- Cart Section -->
    <section class="section-padding" style="padding-top: 0;">
        <div class="container">
            <div id="empty-cart-message" style="text-align: center; padding: 4rem 0; display: none;">
                <p style="font-size: 1.2rem; color: var(--color-text-light); margin-bottom: 1.5rem;">Your cart is empty.
                </p>
                <a href="shop.html" class="btn btn-primary">Start Shopping</a>
            </div>

            <div id="cart-content" style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; display: none;">
                <!-- Left Column - Cart Items -->
                <div>
                    <div id="cart-container">
                        <!-- Cart items injected via JS -->
                    </div>

                    <div id="cart-summary" style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid #eee;">
                        <div style="margin-bottom: 2rem;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <span style="color: var(--color-text-light);">Subtotal</span>
                                <span id="cart-subtotal" style="font-weight: 600;">‚Çπ0</span>
                            </div>
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <span style="color: var(--color-text-light);">Shipping</span>
                                <span id="cart-shipping" style="font-weight: 600;">‚Çπ0</span>
                            </div>
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; padding-top: 1rem; border-top: 1px solid #eee;">
                                <span style="font-size: 1.5rem; font-weight: 700;">Total</span>
                                <span id="cart-total"
                                    style="font-size: 1.5rem; font-weight: 700; color: var(--color-primary);">‚Çπ0</span>
                            </div>
                            <div id="free-delivery-msg"
                                style="text-align: center; margin-top: 1rem; font-size: 0.9rem; color: var(--color-primary);">
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <a href="shop.html" class="btn btn-outline" style="margin-right: 1rem;">Continue
                                Shopping</a>
                        </div>
                    </div>
                </div>

                <!-- Right Column - Payment QR Code -->
                <div style="position: sticky; top: 100px;">
                    <div
                        style="background: white; padding: 1.25rem; border-radius: var(--radius-lg); box-shadow: var(--shadow-md); max-width: 360px; margin: 0 auto;">
                        <h2
                            style="margin-bottom: 0.75rem; color: var(--color-primary); text-align: center; font-size: 1.25rem;">
                            Complete
                            Payment</h2>
                        <!-- UPI ID Display -->
                        <div
                            style="margin-bottom: 1rem; padding: 0.5rem; background: var(--color-bg); border-radius: var(--radius-sm); font-size: 0.8rem; text-align: center; color: var(--color-text-light);">
                            <div>UPI ID: <strong>manojrowdy073-3@okicici</strong></div>
                            <div>Payee: <strong>MANOJKUMAR MARIYAPPAN</strong></div>
                        </div>

                        <p
                            style="text-align: center; color: var(--color-text-light); margin-bottom: 1rem; font-size: 0.85rem;">
                            Scan QR code to pay</p>

                        <!-- QR Code -->
                        <div style="text-align: center; margin-bottom: 1rem;">
                            <div id="qr-code-container"
                                style="display: inline-block; padding: 0.75rem; background: white; border-radius: var(--radius-md); box-shadow: var(--shadow-sm);">
                                <!-- QR code will be generated here -->
                            </div>
                        </div>

                        <!-- Amount Display -->
                        <div
                            style="background: linear-gradient(135deg, #e9f5f0 0%, #f0f9f4 100%); padding: 0.75rem; border-radius: var(--radius-sm); margin-bottom: 1rem; text-align: center;">
                            <div style="font-size: 0.85rem; color: var(--color-text-light); margin-bottom: 0.25rem;">
                                Amount to Pay</div>
                            <div id="payment-amount"
                                style="font-size: 1.75rem; font-weight: 700; color: var(--color-primary);">‚Çπ0</div>
                        </div>



                        <!-- Payment Confirmation -->
                        <div style="border-top: 2px solid var(--color-bg); padding-top: 1rem;">
                            <button id="payment-done-btn" class="btn btn-primary"
                                style="width: 100%; padding: 0.85rem; font-size: 1rem;">
                                I've Completed Payment
                            </button>
                            <p
                                style="text-align: center; font-size: 0.8rem; color: var(--color-text-light); margin-top: 0.5rem;">
                                Click after completing UPI payment
                            </p>
                        </div>



                        <!-- Trust Badges -->
                        <div style="margin-top: 1rem; padding-top: 1rem; border-top: 2px solid var(--color-bg);">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                                <!-- Secure Payment Badge -->
                                <div
                                    style="display: flex; align-items: center; gap: 0.5rem; padding: 0.4rem; background: linear-gradient(135deg, #e8f5e9, #f1f8f4); border-radius: var(--radius-sm);">
                                    <div style="font-size: 1rem;">üîí</div>
                                    <div style="font-size: 0.7rem; line-height: 1.2;">
                                        <div style="font-weight: 600; color: var(--color-primary);">Secure</div>
                                        <div style="color: var(--color-text-light);">Payment</div>
                                    </div>
                                </div>

                                <!-- Verified Business Badge -->
                                <div
                                    style="display: flex; align-items: center; gap: 0.5rem; padding: 0.4rem; background: linear-gradient(135deg, #e3f2fd, #f0f7fc); border-radius: var(--radius-sm);">
                                    <div style="font-size: 1rem;">‚úì</div>
                                    <div style="font-size: 0.7rem; line-height: 1.2;">
                                        <div style="font-weight: 600; color: #1976d2;">Verified</div>
                                        <div style="color: var(--color-text-light);">Business</div>
                                    </div>
                                </div>

                                <!-- Money-Back Guarantee -->
                                <div
                                    style="display: flex; align-items: center; gap: 0.5rem; padding: 0.4rem; background: linear-gradient(135deg, #fff3e0, #fff8f0); border-radius: var(--radius-sm);">
                                    <div style="font-size: 1rem;">üíØ</div>
                                    <div style="font-size: 0.7rem; line-height: 1.2;">
                                        <div style="font-weight: 600; color: #f57c00;">Money-Back</div>
                                        <div style="color: var(--color-text-light);">Guarantee</div>
                                    </div>
                                </div>

                                <!-- Customer Reviews -->
                                <div
                                    style="display: flex; align-items: center; gap: 0.5rem; padding: 0.4rem; background: linear-gradient(135deg, #fce4ec, #fef0f5); border-radius: var(--radius-sm);">
                                    <div style="font-size: 1rem;">‚≠ê</div>
                                    <div style="font-size: 0.7rem; line-height: 1.2;">
                                        <div style="font-weight: 600; color: #c2185b;">500+</div>
                                        <div style="color: var(--color-text-light);">Happy Customers</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <style>
        .upi-app-btn:hover {
            border-color: var(--color-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 968px) {
            #cart-content {
                grid-template-columns: 1fr !important;
            }
        }
    </style>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>Senthoor Oils</h3>
                    <p style="opacity: 0.8; margin-bottom: 1rem;">Empowering farmers, nourishing families.</p>
                </div>
                <div class="footer-col">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="shop.html">Shop</a></li>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Contact Us</h3>
                    <ul class="footer-links">
                        <li>Email: Senthooroils07@gmail.com</li>
                        <li>Phone: +91 75983 20662</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                &copy; 2024 Senthoor Oils. All rights reserved.
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <script src="js/data.js"></script>
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            renderCart();
        });

        function renderCart() {
            const emptyMessage = document.getElementById('empty-cart-message');
            const cartContent = document.getElementById('cart-content');
            const container = document.getElementById('cart-container');
            const totalEl = document.getElementById('cart-total');

            if (cart.length === 0) {
                emptyMessage.style.display = 'block';
                cartContent.style.display = 'none';
                return;
            }

            emptyMessage.style.display = 'none';
            cartContent.style.display = 'grid';

            const subtotal = getCartTotal();
            const shipping = getShippingCost();
            const total = getFinalTotal();

            // Update cart summary
            document.getElementById('cart-subtotal').textContent = formatPrice(subtotal);

            const shippingEl = document.getElementById('cart-shipping');
            if (shipping === 0) {
                shippingEl.textContent = 'Free';
                shippingEl.style.color = 'var(--color-primary)';
            } else {
                shippingEl.textContent = formatPrice(shipping);
                shippingEl.style.color = 'var(--color-text-main)';
            }

            document.getElementById('cart-total').textContent = formatPrice(total);
            document.getElementById('payment-amount').textContent = formatPrice(total);

            const msgEl = document.getElementById('free-delivery-msg');
            if (subtotal > 999) {
                msgEl.textContent = 'üéâ You have qualified for Free Delivery!';
            } else {
                const remaining = 1000 - subtotal;
                msgEl.textContent = `Add items worth ‚Çπ${remaining} more for Free Delivery!`;
            }

            // Render cart items
            container.innerHTML = cart.map(item => `
                <div class="cart-item" style="display: flex; align-items: center; gap: 1.5rem; padding: 1.5rem 0; border-bottom: 1px solid #eee;">
                    <div style="width: 80px; height: 80px; border-radius: var(--radius-md); overflow: hidden; flex-shrink: 0;">
                        <img src="${item.image}" alt="${item.name}" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.1rem; margin-bottom: 0.25rem;">${item.name}</h3>
                        <p style="color: var(--color-text-light); font-size: 0.9rem;">Size: ${item.size}</p>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-weight: 700; color: var(--color-primary); margin-bottom: 0.5rem;">${formatPrice(item.price * item.quantity)}</div>
                        <div style="display: flex; align-items: center; gap: 0.5rem; justify-content: flex-end;">
                            <button onclick="updateQuantity('${item.id}', '${item.size}', ${item.quantity - 1})" style="width: 24px; height: 24px; border-radius: 50%; border: 1px solid #ccc; background: white; cursor: pointer;">-</button>
                            <span style="font-weight: 600; min-width: 20px; text-align: center;">${item.quantity}</span>
                            <button onclick="updateQuantity('${item.id}', '${item.size}', ${item.quantity + 1})" style="width: 24px; height: 24px; border-radius: 50%; border: 1px solid #ccc; background: white; cursor: pointer;">+</button>
                        </div>
                        <button onclick="removeFromCart('${item.id}', '${item.size}')" style="color: var(--color-error); background: none; border: none; font-size: 0.8rem; margin-top: 0.5rem; cursor: pointer; text-decoration: underline;">Remove</button>
                    </div>
                </div>
            `).join('');

            // Generate UPI QR Code
            generatePaymentQR(total);
        }

        function generatePaymentQR(total) {
            const orderId = 'SO' + Date.now();
            const upiId = 'manojrowdy073-3@okicici';
            const payeeName = 'MANOJKUMAR MARIYAPPAN';
            const transactionNote = `Order ${orderId}`;

            const upiLink = `upi://pay?pa=${upiId}&pn=${encodeURIComponent(payeeName)}&am=${total}&cu=INR&tn=${encodeURIComponent(transactionNote)}`;

            // Generate QR Code using qrcode.js
            const qrContainer = document.getElementById('qr-code-container');
            qrContainer.innerHTML = ''; // Clear previous content
            new QRCode(qrContainer, {
                text: upiLink,
                width: 160,
                height: 160,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });



            // Handle payment confirmation
            document.getElementById('payment-done-btn').onclick = () => {
                const subtotal = getCartTotal();
                const shipping = getShippingCost();

                const orderData = {
                    orderId: orderId,
                    items: cart,
                    subtotal: subtotal,
                    deliveryFee: shipping,
                    total: total,
                    paymentStatus: 'pending_verification',
                    paymentTimestamp: new Date().toISOString(),
                    timestamp: new Date().toISOString()
                };

                // Save to orders history
                const orders = JSON.parse(localStorage.getItem('orders')) || [];
                orders.push(orderData);
                localStorage.setItem('orders', JSON.stringify(orders));

                // Clear cart
                cart = [];
                localStorage.removeItem('cart');
                localStorage.removeItem('ak_organics_cart');

                // Redirect to confirmation page
                window.location.href = `order-confirmation.html?orderId=${orderId}`;
            };
        }
    </script>
</body>

</html>